# =====================================================
# PROJECT: StarNote-like Drawing App + pub.dev Library
# OWNER: Ä°lyas AktaÅŸ
# TOOLS: Cursor IDE (Implementer) + Claude Opus (Architect)
# =====================================================

# -----------------------------------------------------
# PHASE STATUS (UPDATED: 2025-01-13)
# -----------------------------------------------------
- Phase 0: COMPLETE âœ… (Scaffolding, Architecture)
- Phase 1: IN PROGRESS ðŸ”„ (UI Skeleton - Needs Update)
  - Core UI: DONE âœ…
  - Missing: Kement panel, Lazer details, Toolbar buttons, Shape expansion
  - See: PHASE1_UI_REFERENCE.md for exact requirements
- Phase 2: NOT STARTED (Drawing Core, Domain Logic)
- Phase 3: NOT STARTED (Undo/Redo, AI, Premium, Persistence)

âš ï¸ DO NOT proceed to Phase 2 until Phase 1 is fully complete.
âš ï¸ Phase 1 completion requires matching PHASE1_UI_REFERENCE.md exactly.

# -----------------------------------------------------
# PROJECT DOCUMENTS (MANDATORY AWARENESS)
# -----------------------------------------------------
Cursor MUST be aware of and respect the following files:

Priority Order:
1. PHASE1_UI_REFERENCE.md  â† NEW: Exact UI specifications from screenshots
2. CHECKLIST_TODO.md       â† Task tracking
3. ARCHITECTURE.md         â† Package structure & boundaries
4. PERFORMANCE_STRATEGY.md â† Performance rules
5. DESIGN_SYSTEM.md        â† Visual language

Rules:
- Before starting any task, CHECK these documents.
- If a checklist item is completed:
  - Mark it as completed (âœ…) in CHECKLIST_TODO.md
- NEVER mark an item complete unless functionality + tests exist.
- If a task touches architecture or performance:
  - Ensure it aligns with ARCHITECTURE.md
  - Ensure it follows PERFORMANCE_STRATEGY.md

# -----------------------------------------------------
# FILE SIZE & STRUCTURE RULES (VERY IMPORTANT)
# -----------------------------------------------------
- A single Dart file SHOULD NOT exceed ~300 lines.
- If a file grows too large:
  - Split it into smaller, purpose-specific files.
- Prefer:
  - One responsibility per file
  - Clear naming over clever abstractions
- NEVER create "god files".

# -----------------------------------------------------
# GLOBAL SAFETY RULES (MANDATORY)
# -----------------------------------------------------
- NEVER delete or rewrite existing working code unless explicitly instructed.
- NEVER remove or weaken existing tests or golden files.
- NEVER change public APIs without explicit approval.
- ALWAYS prefer extending over modifying existing code.
- Keep changes minimal, explicit, and reviewable.

# -----------------------------------------------------
# PHASE 1 RULES (CURRENT WORK - UI UPDATE)
# -----------------------------------------------------
Phase 1 Update MUST:
- Follow PHASE1_UI_REFERENCE.md exactly
- Match reference screenshots pixel-perfect where possible
- Add missing panels (Kement/Lasso, Lazer updates)
- Expand toolbar with right-side buttons
- Expand shapes panel to 24+ shapes
- Update provider state for new features
- Add tests for new components

Phase 1 Update MUST NOT:
- Add any real drawing logic
- Add any real AI integration
- Add any real premium/subscription logic
- Add any database implementation
- Break existing working components

# -----------------------------------------------------
# IMPLEMENTATION STYLE
# -----------------------------------------------------
- Follow Clean Architecture principles.
- No business logic inside widgets.
- No implicit state mutation.
- Prefer immutable models where possible.
- Avoid code duplication at all costs.
- Explicit > implicit.
- Readability > cleverness.

# -----------------------------------------------------
# TESTING RULES
# -----------------------------------------------------
- Every new UI component MUST include widget tests.
- Tests must be deterministic.
- Golden tests MUST NOT be updated unless explicitly requested.
- If a test fails:
  - Fix the implementation
  - NEVER disable the test

# -----------------------------------------------------
# PERFORMANCE RULES
# -----------------------------------------------------
- Respect PERFORMANCE_STRATEGY.md at all times.
- No unnecessary allocations in hot paths.
- No deep object cloning unless required.
- No synchronous heavy work in UI threads.

# -----------------------------------------------------
# GIT WORKFLOW RULES
# -----------------------------------------------------
- ALWAYS work on a feature branch.

Branch naming for Phase 1 update:
- feature/phase1-ui-update
- feature/phase1-kement-panel
- feature/phase1-toolbar-expansion

Before implementing:
- Confirm branch name
- Confirm task scope
- Confirm alignment with PHASE1_UI_REFERENCE.md

After implementing:
- Summarize changes
- List modified files
- Suggest a commit message
- Ask the user to commit

Cursor MUST:
- NEVER auto-commit
- NEVER push to remote unless explicitly instructed

# -----------------------------------------------------
# CHANGE RISK PROTOCOL
# -----------------------------------------------------
If a requested change:
- Risks breaking existing behavior
- Conflicts with PHASE1_UI_REFERENCE.md
- Conflicts with ARCHITECTURE.md
- Conflicts with PERFORMANCE_STRATEGY.md

Then:
- STOP
- WARN the user
- Ask for explicit confirmation

# -----------------------------------------------------
# COMMUNICATION RULES
# -----------------------------------------------------
Cursor MUST:
- Explain WHAT was done
- Explain WHY it was done
- Clearly list affected files
- Explicitly state what is TODO or intentionally mocked
- Reference which PHASE1_UI_REFERENCE.md section was implemented
- NEVER silently override previous decisions

# -----------------------------------------------------
# FORBIDDEN ACTIONS
# -----------------------------------------------------
- No large refactors without request
- No speculative features
- No phase skipping
- No "cleanup only" commits
- No silent behavior changes
- No deviation from PHASE1_UI_REFERENCE.md without approval

# -----------------------------------------------------
# FINAL GOAL REMINDER
# -----------------------------------------------------
This project targets:
- Production-grade performance
- pub.dev quality standards
- Long-term maintainability
- StarNote-like user experience

Stability, clarity, and testability
are more important than speed.

# -----------------------------------------------------
# QUICK REFERENCE: Phase 1 Remaining Tasks
# -----------------------------------------------------
â–¡ Kement (Lasso Selection) Panel - NEW
â–¡ Lazer Panel Update (mode + duration)
â–¡ Toolbar Right Action Buttons
â–¡ Toolbar Quick Color/Thickness Row
â–¡ Shapes Panel Expansion (8 â†’ 24+ shapes)
â–¡ Pen Panel Preview Update
â–¡ Highlighter Panel Preview Update
â–¡ Sticker Panel Category Update
â–¡ Provider Updates for new state
â–¡ Tests for all new components

See PHASE1_UI_REFERENCE.md for full specifications.
